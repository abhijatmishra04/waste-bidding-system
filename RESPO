private List<String> fetchAndUpdateTransferExecutionIds(List<String> scheduleIds) {
    List<String> transferExecutionIds = new ArrayList<>();
    for (String scheduleId : scheduleIds) {
        try {
            String transferExecutionId = jdbcTemplate.queryForObject(
                CustaggSQLFactory.FETCH_TRANSFER_EXECUTION_M2M_ID,
                new Object[]{scheduleId},
                String.class
            );
            if (transferExecutionId != null) {
                transferExecutionIds.add(transferExecutionId);
                log.info("Fetched Transfer Execution ID: {}", transferExecutionId);
            } else {
                log.info("No Transfer Execution ID found for Schedule ID: {}", scheduleId);
            }
        } catch (Exception e) {
            log.info("Error fetching Transfer Execution ID for Schedule ID: {}", scheduleId, e);
        }
    }

    // Pass the list to the batch update method
    if (!transferExecutionIds.isEmpty()) {
        updateTransferExecution(transferExecutionIds);
    }

    return transferExecutionIds;
}


private void updateTransferExecution(List<String> transferExecutionIds) {
    try {
        jdbcTemplate.batchUpdate(
            CustaggSQLFactory.UPDATE_TRANSFER_EXECUTION_M2M,
            transferExecutionIds,
            transferExecutionIds.size(),
            (ps, transferExecutionId) -> {
                ps.setString(1, "CUSTAGG"); // updt_by
                ps.setTimestamp(2, new Timestamp(System.currentTimeMillis())); // updt_ts
                ps.setString(3, transferExecutionId); // xfer_exeq_m2m_id
            }
        );
        log.info("Batch updated Transfer Execution M2M for IDs: {}", transferExecutionIds);
    } catch (Exception e) {
        log.info("Error updating Transfer Execution M2M for IDs: {}", transferExecutionIds, e);
    }
}
