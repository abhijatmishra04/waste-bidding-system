<?xml version="1.0" encoding="UTF-8"?>
<Configuration status="WARN">

  <Appenders>
    <!-- ********** 1) Existing Application Appender ********** -->
    <RollingFile name="appAppender"
                 fileName="${sys:jboss.server.log.dir}/sst_bp_m2m_poe/batch/application.log"
                 filePattern="${sys:jboss.server.log.dir}/archive/sst_bp_m2m_poe/batch/application-%d{MM-dd-yyyy}-%i.log.gz">
      <PatternLayout>
        <Pattern>%d %-5p %t %c{2}:%L - %m%n</Pattern>
      </PatternLayout>
      <Policies>
        <SizeBasedTriggeringPolicy size="300 MB"/>
      </Policies>
      <DefaultRolloverStrategy max="10">
        <Delete basePath="${sys:jboss.server.log.dir}/archive/sst_bp_m2m_poe/batch/">
          <IfFileName glob="application-*.log.gz"/>
          <IfAny>
            <IfLastModified age="7d"/>
            <IfAccumulatedFileCount exceeds="15"/>
          </IfAny>
        </Delete>
      </DefaultRolloverStrategy>
    </RollingFile>

    <!-- ********** 2) NEW: Splunk Appender ********** -->
    <!--   Add exactly this under <Appenders> -->
    <RollingFile name="splunkAppender"
                 fileName="${sys:jboss.server.log.dir}/sst_bp_m2m_poe/batch/splunk.log"
                 filePattern="${sys:jboss.server.log.dir}/archive/sst_bp_m2m_poe/batch/splunk-%d{MM-dd-yyyy}-%i.log.gz">
      <PatternLayout>
        <!-- Only timestamp | message, since Splunk typically parses those -->
        <Pattern>%d{dd/MMM/yyyy:HH:mm:ss.SSS 'Z'}| %m%n</Pattern>
      </PatternLayout>
      <Policies>
        <SizeBasedTriggeringPolicy size="300 MB"/>
      </Policies>
      <DefaultRolloverStrategy max="10">
        <Delete basePath="${sys:jboss.server.log.dir}/archive/sst_bp_m2m_poe/batch/">
          <IfFileName glob="splunk-*.log.gz"/>
          <IfAny>
            <IfLastModified age="7d"/>
            <IfAccumulatedFileCount exceeds="15"/>
          </IfAny>
        </Delete>
      </DefaultRolloverStrategy>
    </RollingFile>
    <!-- ********** END Splunk Appender ********** -->
  </Appenders>


  <Loggers>
    <!-- ********** 3) Modify/Add this LOGGER for your package ********** -->
    <!-- Anything logged under com.bofa.sst.batch will now go to BOTH appAppender AND splunkAppender -->
    <Logger name="com.bofa.sst.batch" level="debug" additivity="false">
      <AppenderRef ref="appAppender"/>
      <AppenderRef ref="splunkAppender"/>
    </Logger>
    <!-- ********** END Package Logger ********** -->

    <!-- (You can leave your other Logger entries untouched.  Just be sure not to override com.bofa.sst.batch.) -->

    <!-- ********** 4) Root logger stays pointing to appAppender ********** -->
    <Root level="info">
      <AppenderRef ref="appAppender"/>
    </Root>
  </Loggers>

</Configuration>
