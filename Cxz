Seq
Business Logic / Validation
Pre-Processing
1
Retrieve the input folder path and expected file prefix from job parameters.
2
Locate today’s trigger file. If it is missing, stop the job and raise an error.
3
Compare the trigger file name against the archive area. If the same file already exists there, treat it as a duplicate and fail the job.
4
Attempt to lock the trigger file. If the lock cannot be obtained, halt processing and report the issue.
Record Preparation
5
Skip any rows inside the file that share the same Bank-ID (duplicates within the same run).
6
Populate all mandatory fields with standard default values (dates, flags, blanks, zeros, etc.).
7
Check the database for each Bank-ID: • If a matching row exists, mark the record for update. • If no match is found, mark it for insert.
Database Persistence
8
Update path → Refresh the existing row with the latest values. If no row is affected, log a “zero-update” informational message.
9
Insert path → Create a new record. Confirm exactly one row is inserted; log any anomaly.
10
Maintain running totals of rows updated and rows inserted for end-of-batch reporting.
Wrap-Up
11
Write a summary to the job log showing total inserts, total updates, and any errors encountered.
12
Mark the batch as successfully completed if no critical errors were raised during the previous steps.
