<!-- Appender for Splunk forwarding -->
<RollingFile name="splunkAppender"
             fileName="${sys:jboss.server.log.dir}/sst_bp_m2m_custagg/batch/splunk.log"
             filePattern="${sys:jboss.server.log.dir}/archive/sst_bp_m2m_custagg/batch/splunk-%d{MM-dd-yyyy}-%i.log.gz">

    <!--  [12/Jun/2025:13:55:42.173 Z]  actual-log-line -->
    <PatternLayout>
        <Pattern>[%%d{dd/MMM/yyyy:HH:mm:ss.SSS' Z'}] %%m%%n</Pattern>
    </PatternLayout>

    <Policies>
        <!-- roll every 300 MB -->
        <SizeBasedTriggeringPolicy size="300 MB"/>
    </Policies>

    <DefaultRolloverStrategy max="10">
        <Delete basePath="${sys:jboss.server.log.dir}/archive/sst_bp_m2m_custagg/batch/">
            <IfFileName glob="splunk-*.log.gz">
                <IfAny>
                    <!-- keep at most 7 days OR 15 files -->
                    <IfLastModified age="7d"/>
                    <IfAccumulatedFileCount exceeds="15"/>
                </IfAny>
            </IfFileName>
        </Delete>
    </DefaultRolloverStrategy>
</RollingFile>

<Logger name="com.bofa.sst.batch" level="debug" additivity="false">
    <AppenderRef ref="appAppender"/>
    <AppenderRef ref="splunkAppender"/>   <!-- NEW -->
</Logger>
