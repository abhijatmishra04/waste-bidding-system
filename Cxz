# pip install "locust==2.41.2"

client = RAIGatewayClient.from_cfg(
    "rai_config.toml",
    profile="WITH_GUARDRAIL",
    log_file="rai_client_events.jsonl",     # general event log (optional)
    manual_metrics_log_file="manual_metrics.jsonl",
    locust_metrics_log_file="locust_metrics.jsonl",
    metrics_log_every_call=True,            # snapshot after every call
)

# make calls
_ = client.call_chat(
    messages=[{"role": "user", "content": "Hello"}],
    model="gateway/chat",
)

# pull metrics on demand
print(json.dumps(client.get_manual_metrics(), indent=2))
print(json.dumps(client.get_locust_metrics("gateway/chat"), indent=2))
print(json.dumps(client.get_metrics("gateway/chat"), indent=2))

# reset if you want a fresh window
client.reset_metrics()
